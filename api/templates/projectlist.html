{% extends "base.html" %}
{% block css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/summary.css') }}">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.13.1/css/bootstrap-select.css" />
<link href="https://unpkg.com/gijgo@1.9.13/css/gijgo.min.css" rel="stylesheet" type="text/css" />
{% endblock %}
{% block script %}
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.13.1/js/bootstrap-select.min.js"></script>
<script src="https://unpkg.com/gijgo@1.9.13/js/gijgo.min.js" type="text/javascript"></script>
<script>
function show_all() {
  $(".open").show();
  $(".complete").show();
  $(".notstarted").show();
  $('#hc').removeAttr("disabled");
  $('#ho').removeAttr("disabled");
}

function new_project(sel) {
  window.location.href = '/newproject/' + sel.value;
}

function change_date()
{
  protocols = $('#protocol').val();
  if ($('#start').val()) {
    start = $('#start').val();
  }
  else {
    start = '2019-09-01';
  }
  url = '/projectlist/' + protocols + '/' + start;
  if ($('#stop').val()) {
    url += '/' + $('#stop').val();
  }
  window.location.href = url;
}
$('select').selectpicker();
</script>
{% endblock %}
{% block onload %}
onload="tableInitialize();"
{% endblock %}

{% block content %}
  {{navbar|safe}}
  <h2>Projects</h2>
  {{newproject|safe}}
  <div style='float: left;margin:10px 0 15px 0;'>
  <div style='float: left'>Start date:</div><div style='float: left;margin-left: 10px;'><input id="start" width=200></div>
  <div style='float: left;margin-left: 10px;'>Stop date:</div><div style='float: left;margin-left: 10px;'><input id="stop" width=200></div>
  <div style='float: left;margin-left: 10px;'>
  Select protocol:
  <select id="protocol" class="selectpicker" multiple=1 data-live-search="true" onchange='select_protocol(this);'>
  {{protocols|safe}}
  </select>
  </div>
  <div style='float: left;margin-left: 10px;'><button type="submit" class="btn btn-outline-success btn-sm" onclick="change_date(); href='#'">Reselect projects</button></div>
  </div>
  <script>
    $('#start').datepicker({ uiLibrary: 'bootstrap4', format: 'yyyy-mm-dd', value: '{{start}}', minDate: '2019-09-01' });
    $('#stop').datepicker({ uiLibrary: 'bootstrap4', format: 'yyyy-mm-dd', value: '{{stop}}' });
  </script>
  <div style='clear:both'></div>
  <hr>
  <div>
  <button type="button" class="btn btn-primary btn-sm" onclick='show_all();'>Show all</button>
  <button id="hc" type="button" class="btn btn-primary btn-sm" onclick='$(".complete").hide(); $("#hc").attr("disabled", true);'>Hide completed</button>
  <button id="ho" type="button" class="btn btn-primary btn-sm" onclick='$(".open").hide(); $("#ho").attr("disabled", true);'>Hide open</button>
  </div>
  <br>
  {{ projects|safe }}
{% endblock %}
